# 概念

1、聚合中的实体中没有业务逻辑代码，只有对象的创建，对象的初始化，状态管理等个体相关的代码。

2、对于聚合内的业务逻辑编写领域服务（Domain Service） 而对于跨聚合协作以及聚合与外部系统协助的逻辑，编写应用服务（application service）.

3、应用服务协调多个领域服务，外部系统来完成一个用例（用户的一件事）

DDD典型用例处理流程

1、准备业务操作数据

2、执行由一个或多个领域模型做出的业务操作，这些会修改实体的状态，或者生成一些操作结果。

3、把对实体的改变或者操作结果应用于外部系统。

职责划分

1、领域服务与外部系统不会发生直接交互，即领域服务不会设计数据库操作

2、业务逻辑放入领域服务，而与外部系统交互由应用服务完成。

3、领域服务不是必须的，在一些简单的业务处理中(crud) 是没有领域知识（业务逻辑），这种情况下应用服务可以完成所有操作，不需要引入领域服务。这样可以避免过度设计。

仓储（repository）和工作单元（unit of work）

1、仓储负责按照要求从数据库中读取数据以及把领域服务修改的数据保存回数据库。

2、聚合内的数据操作是关系非常紧密的，我们要保证事务的强一致性，而聚合间的协作关系不紧密，因此我们只要保证事务的最终一致性即可。

3、聚合内的若干相关联的操作组成一个工作单元 ，工作单元内的修改 要么全部成功，要么全部失败。