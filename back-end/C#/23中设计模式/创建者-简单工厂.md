# 简单工厂

## 需求:请使用任意面向对象编程语言实现计算器控制台应用程序

### 初学者实现

```c#
		    Console.WriteLine("请输入数字A");
            double A = Convert.ToInt32(Console.ReadLine());
            Console.WriteLine("请输入操作符（+ - * /）");
            string B = Console.ReadLine();
            Console.WriteLine("请输入数字B");
            double C = Convert.ToInt32(Console.ReadLine());

            double result = 0;
            if (B == "+")
            {
                result = A + C;
            }
            if (B == "-")
            {
                result = A - C;
            }
            if (B == "*")
            {
                result = A * C;
            }
            if (B == "/")
            {
                result = A / C;
            }
            Console.WriteLine($"{A}{B}{C}="+result);
```

![image-20210520155232822](C:\Users\zxc\Desktop\学习笔记\back-end\C#\23中设计模式\image\创建者-简单工厂1.png)

## 问题:

命名不规范

![image-20210520155653847](C:\Users\zxc\Desktop\学习笔记\back-end\C#\23中设计模式\image\创建者-简单工厂2.png)

判断分支每个都要判断-三次无用功

![image-20210520155828662](C:\Users\zxc\Desktop\学习笔记\back-end\C#\23中设计模式\image\创建者-简单工厂3.png)

没有校验输入的值,如果输入的不是数字或者除数为0

![image-20210520160005404](C:\Users\zxc\Desktop\学习笔记\back-end\C#\23中设计模式\image\创建者-简单工厂4.png)

![image-20210520160044976](C:\Users\zxc\Desktop\学习笔记\back-end\C#\23中设计模式\image\创建者-简单工厂5.png)

### 规范实现:

```C#
            Console.WriteLine("请输入数字A");
            string numberA = Console.ReadLine();
            Console.WriteLine("请输入操作符（+ - * /）");
            string operate = Console.ReadLine();
            Console.WriteLine("请输入数字B");
            string numberB = Console.ReadLine();

            string[] operates = new string[] { "+", "-", "*", "/" };
            if (!operates.Contains(operate))
            {
                throw new Exception("操作符输入有误");
            }
            double numA = 0;
            double numB = 0;
            if (!double.TryParse(numberA, out numA))
            {
                throw new Exception("数字A输入有误");
            }
            if (!double.TryParse(numberB, out numB))
            {
                throw new Exception("数字B输入有误");
            }

            double result1 = 0;
            switch (operate)
            {
                case "+":
                    result1 = numA + numB;
                    break;
                case "-":
                    result1 = numA - numB;
                    break;
                case "*":
                    result1 = numA * numB;
                    break;
                case "/":
                    if (numB == 0)
                    {
                        throw new Exception("除数不能为0");
                    }
                    result1 = numA / numB;
                    break;
                default: throw new Exception("啥也不是!");
            }

            Console.WriteLine($"{ numA}{ operate}{ numB}={result1}");
```

## 问题:不易扩展、不够灵活、不易复用

### 简单工厂实现（封装，继承，多态）

```C#
	/// <summary>
    /// 父类
    /// </summary>
    class Operation
    {
        public double numA { get; set; }
        public double numB { get; set; }

        public virtual double GetResult()
        {
            double result = 0;
            return result;
        }
    }

    /// <summary>
    /// 加法运算
    /// </summary>
    class AddOperation : Operation
    {
        public override double GetResult()
        {

            return numA + numB;
        }
    }

    /// <summary>
    /// 减法运算
    /// </summary>
    class SubOperation : Operation
    {
        public override double GetResult()
        {
            return numA - numB;
        }
    }
    /// <summary>
    /// 乘法运算
    /// </summary>
    class MulOperation : Operation
    {
        public override double GetResult()
        {
            return numB * numA;
        }
    }

    /// <summary>
    /// 除法运算
    /// </summary>
    class DivOperation : Operation
    {
        public override double GetResult()
        {
            if (numB == 0)
            {
                throw new Exception("除数不能为0");
            }
            return numA / numB;
        }
    }

    /// <summary>
    /// 工厂类
    /// </summary>
    class Factory
    {
        public static Operation CreatOperation(string operation)
        {
            Operation operation1 = null;
            switch (operation)
            {
                case "+":
                    operation1 = new AddOperation();
                    break;
                case "-":
                    operation1 = new SubOperation();
                    break;
                case "*":
                    operation1 = new MulOperation();
                    break;
                case "/":
                    operation1 = new DivOperation();
                    break;
                default:
                    throw new Exception("不存在得操作符!");
            }
            return operation1;
        }
    }
```

```C#
            Console.WriteLine("请输入数字A");
            string numberA1 = Console.ReadLine();
            Console.WriteLine("请输入操作符（+ - * /）");
            string operate1 = Console.ReadLine();
            Console.WriteLine("请输入数字B");
            string numberB1 = Console.ReadLine();

            double numA1 = 0;
            double numB1 = 0;
            if (!double.TryParse(numberA1, out numA1))
            {
                throw new Exception("数字A输入有误");
            }
            if (!double.TryParse(numberB1, out numB1))
            {
                throw new Exception("数字B输入有误");
            }

            Operation operation = Factory.CreatOperation(operate1);
            operation.numA = numA1;
            operation.numB = numB1;
            double result = operation.GetResult();
            Console.WriteLine($"{numA1}{operate1}{numB1}={result}");
```

后续添加算法就修改switch 和添加运算子类继承Opertion 就行了。